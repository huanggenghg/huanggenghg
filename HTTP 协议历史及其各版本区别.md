## HTTP 协议历史及其各版本区别

### HTTP/0.9

1990 年问世，只支持 GET，不支持 MIME 类型；协议还规定，服务器只能回应 HTML 格式的字符串，当服务器发送完毕，就关闭 TCP 连接。

### HTTP/1.0

作为标准被公布是在 1996 年 5 月。

- 发送任意格式
- 除了 GET 还引入 POST 和 HEAD
- 请求及响应格式发生变化，除了数据部分，每次通信都必须包括头信息（HTTP header），用来描述一些元数据
- 状态码、多字符集支持、多部分发送（multi-part type）、权限（authorization）、缓存、内容编码等
- 不足是**每个 TCP 连接只能发送一个请求，发送数据完毕，连接就关闭**，如果还要请求其他资源，就必须再新建一个连接。TCP 连接的新建成本很高，因为需要客户端和服务器三次握手，并且开始时发送速率较慢。所以性能比较差。

### HTTP/1.1

目前主流 HTTP 协议版本，公布于 1997 年。

- 引入了持久连接（persistent connection），即 TCP 连接默认不关闭，可以被多个请求复用，不用声明 Connection:keep-alive。客户端和服务器发现对方一段时间没有活动，就可以主动关闭连接。不过，规范的做法是，客户端在最后一个请求时，发送 Connection:close，明确服务器关闭 TCP  连接；
- 引入了管道机制（pipelining），即在同一个 TCP 连接里面，客户端可以同时发送多个请求；但服务器还是按顺序进行回应；
- 将 Content-length 字段的作用进行扩充，即声明本次回应的数据长度（一个 TCP 现可传送多个回应，势必就要有一种机制，区分数据包是属于哪一个回应的）
- 采用分块传输编码，对于一些很耗时的动态操作，服务器需要等到所有操作完成，才能发送数据，显然这样的效率不高。更好的处理方法是，产生一块数据，就发送一块，采用"流模式"（stream）取代"缓存模式"（buffer）
- 新增：PUT、PATCH、HEAD、 OPTIONS、DELETE。另外，客户端请求的头信息新增了Host字段，用来指定服务器的域名
- 队头阻塞（Head-of-line blocking）：虽然1.1版允许复用TCP连接，但是同一个TCP连接里面，所有的数据通信是按次序进行的。服务器只有处理完一个回应，才会进行下一个回应。要是前面的回应特别慢，后面就会有许多请求排队等着。两种方法：一是减少请求数，二是同时多开持久连接。

### HTTP/2

发布于 2015 年，主要是基于 **SPDY 协议**，其特点是：在不改动 HTTP 语义、方法、状态码、URI 及手部字段的情况下，大幅度提高了 Web 性能。

> SPDY是Speedy的昵音，意为“更快”。它是Google开发的基于TCP协议的应用层协议。**目标是优化HTTP协议的性能，通过压缩、多路复用和优先级等技术，缩短网页的加载时间并提高安全性**。SPDY协议的核心思想是尽量减少TCP连接数。SPDY并不是一种用于替代HTTP的协议，而是对HTTP协议的增强。

- 头信息是一个彻底的二进制协议，头信息和数据体都是二进制，并且统称为“帧”（frame）：头信息帧和数据帧
- 复用TCP连接，在一个连接里，客户端和浏览器都可以同时发送多个请求或回应，而且不用按照顺序一一对应，这样就避免了"队头堵塞"。
- 因为 HTTP/2 的数据包是不按顺序发送的，同一个连接里面连续的数据包，可能属于不同的回应。因此，必须要对数据包做标记，指出它属于哪个回应。
- HTTP 协议不带有状态，每次请求都必须附上所有信息。所以，请求的很多字段都是重复的，比如Cookie和User Agent，一模一样的内容，每次请求都必须附带，这会浪费很多带宽，也影响速度。
- HTTP/2 允许服务器未经请求，主动向客户端发送资源，这叫做服务器推送（server push）。

#### HTTP 1.x 的缺点

1. HTTP/1.0 一次只允许在一个 TCP 连接上发起一个请求，HTTP/1.1 使用的流水线技术也只能处理部分处理请求并发，仍会存在队列头阻塞问题，因此客户端在需要发起多次请求时，通常会采用建立多连接来减少延迟。
2. 单向请求，只能由客户端发起。
3. 请求报文与响应报文手部信息冗余量大。
4. 数据未压缩，导致数据的传输量大。

*摘录自* [*HTTP 0.9、1.0、1.1、2.0、3.0*](https://www.cnblogs.com/FdWzy/p/12567822.html)

